<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta name="description" content="ECHOSYSTEMS: immersive audiovisual work by maro kariya and ethan marshall cohen." />
  <title>ECHOSYSTEMS — maro kariya x ethan marshall cohen</title>
  <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
  <style>
    /* ... your existing styles unchanged ... */
  </style>
</head>
<body>
  <header>
    <h1>ECHOSYSTEMS</h1>
    <h2>maro kariya x ethan marshall cohen</h2>
  </header>
  <div class="instructions">
    The following are 360° videos with third-order ambisonic audio.<br>
    Once playing, click+drag to change the field of view and listening orientation.<br>
    Scroll to acoustically 'zoom' closer to and further from the sounds you are oriented toward.
  </div>
  <main>
    <!-- ... your existing HTML unchanged ... -->

    <!-- Hidden HOAST360 player that moves to active wrapper -->
    <div class="hidden-player">
      <video-js
        id="hoast360-player"
        class="video-js vjs-fluid vjs-big-play-centered"
        controls
        preload="auto"
        crossorigin="anonymous"
        data-setup='{"fluid": true}'
      >
        <p class="vjs-no-js">
          To view this video please enable JavaScript, and consider upgrading to a web browser that
          <a href="https://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>.
        </p>
      </video-js>
    </div>
  </main>
  <script src="./dist/hoast360.bundle.js"></script>
  <script>
    let hoast360;
    let isInitialized = false;
    let currentVideo = null;

    const videos = {
      hovering: {
        url: "https://pub-50ad6c6851e94dadbf5a2004fd002705.r2.dev/hovering/",
        title: '"hovering" (echosystems, 2025) - maro kariya x ethan marshall cohen'
      },
      desert: {
        url: "https://pub-50ad6c6851e94dadbf5a2004fd002705.r2.dev/desert/",
        title: '"desert" (echosystems, 2025) - maro kariya x ethan marshall cohen'
      },
      wahnabezee: {
        url: "https://pub-50ad6c6851e94dadbf5a2004fd002705.r2.dev/wahnabezee_12025/",
        title: '"Wahnabezee 12025" (Fieldspeakers, 2025) - maro kariya'
      },
      visiting: {
        url: "https://pub-50ad6c6851e94dadbf5a2004fd002705.r2.dev/visiting_shards/",
        title: '"visting shards" (Fieldspeakers, 2025) - ethan marshall cohen'
      }
    };

    function loadVideo(videoKey) {
      const video = videos[videoKey];
      if (!video || currentVideo === videoKey) return;

      // Update UI states
      updateVideoStates(videoKey);

      // Move player to the active wrapper
      const activeWrapper = document.getElementById(`${videoKey}-wrapper`);
      const player = document.getElementById('hoast360-player');

      // Hide overlay and show player
      const overlay = document.getElementById(`${videoKey}-overlay`);
      overlay.style.display = 'none';
      activeWrapper.appendChild(player);

      // Reset if already initialized
      if (isInitialized && hoast360) {
        hoast360.reset();
      }

      // Initialize with new video
      hoast360 = new HOAST360();
      hoast360.initialize(video.url, "/spatialmedia/irs/", 4);
      isInitialized = true;
      currentVideo = videoKey;

      // Auto-play after a short delay
      setTimeout(() => {
        try {
          if (hoast360 && hoast360.player) {
            hoast360.player.ready(() => {
              hoast360.player.play();
            });
          }
        } catch (error) {
          console.log('Auto-play prevented by browser policy');
        }
      }, 1000);
    }

    function updateVideoStates(activeKey) {
      Object.keys(videos).forEach(key => {
        const wrapper = document.getElementById(`${key}-wrapper`);
        const overlay = document.getElementById(`${key}-overlay`);
        const indicator = document.getElementById(`${key}-indicator`);

        if (key === activeKey) {
          wrapper.classList.add('active');
          wrapper.classList.remove('inactive');
          indicator.style.display = 'block';
        } else {
          wrapper.classList.add('inactive');
          wrapper.classList.remove('active');
          overlay.style.display = 'flex';
          indicator.style.display = 'none';
        }
      });
    }

    window.onload = () => {
      // Initialize all wrappers as inactive
      Object.keys(videos).forEach(key => {
        const wrapper = document.getElementById(`${key}-wrapper`);
        wrapper.classList.add('inactive');
      });
    };
  </script>
</body>
</html>
